Deribit TWAP Arbitrage

In crypto options markets like Deribit, the final settlement price of an expiring contract is determined not by a single spot price, but by the 30-minute time-weighted average price (TWAP) of the BTC index leading up to expiration. This structural nuance creates a temporary pricing dislocation between the live market price of an option and its eventual payout value. To identify and quantify this inefficiency, this tool performs two key operations:
(1) it scrapes real-time BTC option prices from Deribit (and optionally OKX), and
(2) it constructs a synthetic “fair value” option price based on the rolling TWAP of the BTC index, using a simplified Black-Scholes-style pricing approach.
The idea is that while the market continues to price options off of the volatile and reactive spot price, the actual payout is based on the smoother TWAP, creating opportunities when these diverge. The TWAP-based model assumes that if the current TWAP were the final settlement price, then the fair value of the option would be roughly equal to its intrinsic value, calculated as max(TWAP - K, 0) for a call. By comparing this synthetic value to the live market price of the same option, the system can detect mispricings in real-time—particularly near expiration, when the TWAP window overlaps with the final minutes of trading.

In essence, the script allows traders to anticipate where the market price should converge based on known settlement mechanics. When the live price trades meaningfully below (or above) this fair value, it may indicate a last-minute arbitrage opportunity, especially in low-latency environments. This project highlights how non-instantaneous settlement design can lead to predictable price drift, enabling proactive positioning ahead of expiry.
